use meitun_dw;
select count(distinct spu_id) from dim_sku where status=1;
use meitun_dw;
set session optimize_hash_generation=true;
with spd as ( select babytree_enc_user_id, case when supplier_id=34 then 1 else 0 end supplier_id, dt from meitun_dw.sale_order_pay_detail where dt>='2016-10-01' and dt<'2017-01-01' ), spo as ( select babytree_enc_user_id from spd group by 1 having count(distinct dt)>1 ), sop as ( select distinct babytree_enc_user_id from spd where supplier_id=1 ) select count(distinct spd.babytree_enc_user_id), count(distinct case when spo.babytree_enc_user_id is not null then spo.babytree_enc_user_id end) from spd left outer join spo using(babytree_enc_user_id);
show tables;
desc dim_category;
desc hier_category;
select;
with spd as ( select babytree_enc_user_id, case when supplier_id=34 then 1 else 0 end supplier_id, category_lvl3_id, dt from meitun_dw.sale_order_pay_detail where dt>='2016-10-01' and dt<'2017-01-01' ), hc as ( select category_lvl3_id from hier_categroy where category_lvl1_name='纸尿裤' ), spo as ( select babytree_enc_user_id from spd group by 1 having count(distinct dt)>1 ), sop as ( select distinct babytree_enc_user_id from spd inner join hc using(category_lvl3_id) where supplier_id=1 ) select count(distinct spd.babytree_enc_user_id), count(distinct case when spo.babytree_enc_user_id is not null then spo.babytree_enc_user_id end) from spd left outer join spo using(babytree_enc_user_id);
with spd as ( select babytree_enc_user_id, case when supplier_id=34 then 1 else 0 end supplier_id, category_lvl3_id, dt from meitun_dw.sale_order_pay_detail where dt>='2016-10-01' and dt<'2017-01-01' ), hc as ( select category_lvl3_id from meitun_dw.hier_categroy where category_lvl1_name='纸尿裤' ), spo as ( select babytree_enc_user_id from spd group by 1 having count(distinct dt)>1 ), sop as ( select distinct babytree_enc_user_id from spd inner join hc using(category_lvl3_id) where supplier_id=1 ) select count(distinct spd.babytree_enc_user_id), count(distinct case when spo.babytree_enc_user_id is not null then spo.babytree_enc_user_id end) from spd left outer join spo using(babytree_enc_user_id);
show tables;
desc hier_category;
with spd as ( select babytree_enc_user_id, case when supplier_id=34 then 1 else 0 end supplier_id, category_lvl3_id, dt from meitun_dw.sale_order_pay_detail where dt>='2016-10-01' and dt<'2017-01-01' ), hc as ( select category_lvl3_id from meitun_dw.hier_category where category_lvl1_name='纸尿裤' ), spo as ( select babytree_enc_user_id from spd group by 1 having count(distinct dt)>1 ), sop as ( select distinct babytree_enc_user_id from spd inner join hc using(category_lvl3_id) where supplier_id=1 ) select count(distinct spd.babytree_enc_user_id), count(distinct case when spo.babytree_enc_user_id is not null then spo.babytree_enc_user_id end) from spd left outer join spo using(babytree_enc_user_id);
with spd as ( select babytree_enc_user_id, case when supplier_id=34 then 1 else 0 end supplier_id, category_lvl3_id, dt from meitun_dw.sale_order_pay_detail where dt>='2016-10-01' and dt<'2017-01-01' ), hc as ( select category_lvl3_id from meitun_dw.hier_category where category_lvl1_name='纸尿裤' ), spo as ( select babytree_enc_user_id from spd group by 1 having count(distinct dt)>1 ), sop as ( select distinct babytree_enc_user_id from spd inner join hc using(category_lvl3_id) where supplier_id=1 ) select count(distinct spd.babytree_enc_user_id), count(distinct case when sop.babytree_enc_user_id is not null then sop.babytree_enc_user_id end) from spd left outer join sop using(babytree_enc_user_id);
with spd as ( select babytree_enc_user_id, case when supplier_id=34 then 1 else 0 end supplier_id, category_lvl3_id, dt from meitun_dw.sale_order_pay_detail where dt>='2016-10-01' and dt<'2017-01-01' ), hc as ( select category_lvl3_id from meitun_dw.hier_category where category_lvl1_name='纸尿裤' ), spo as ( select babytree_enc_user_id from spd group by 1 having count(distinct dt)>1 ), sop as ( select distinct babytree_enc_user_id from spd inner join hc using(category_lvl3_id) where supplier_id=1 ) select count(distinct sop.babytree_enc_user_id), count(distinct case when spo.babytree_enc_user_id is not null then spo.babytree_enc_user_id end) from sop left outer join spo using(babytree_enc_user_id);
with spd as ( select babytree_enc_user_id, case when supplier_id=0 then 1 else 0 end supplier_id, category_lvl3_id, dt from meitun_dw.sale_order_pay_detail where dt>='2016-10-01' and dt<'2017-01-01' ), hc as ( select category_lvl3_id from meitun_dw.hier_category where category_lvl1_name='纸尿裤' ), spo as ( select babytree_enc_user_id from spd group by 1 having count(distinct dt)>1 ), sop as ( select distinct babytree_enc_user_id from spd inner join hc using(category_lvl3_id) where supplier_id=1 ) select count(distinct sop.babytree_enc_user_id), count(distinct case when spo.babytree_enc_user_id is not null then spo.babytree_enc_user_id end) from sop left outer join spo using(babytree_enc_user_id);
with spd as ( select babytree_enc_user_id, category_lvl3_id, dt from meitun_dw.sale_order_pay_detail where dt>='2016-10-01' and dt<'2017-01-01' ), hc as ( select category_lvl3_id from meitun_dw.hier_category where category_lvl1_name='纸尿裤' ), spo as ( select babytree_enc_user_id from spd group by 1 having count(distinct dt)=1 ), sop as ( select distinct babytree_enc_user_id from spd inner join hc using(category_lvl3_id) ) select count(distinct sop.babytree_enc_user_id), count(distinct case when spo.babytree_enc_user_id is not null then spo.babytree_enc_user_id end) from sop left outer join spo using(babytree_enc_user_id);
select * from dim_brand where brand_name='小熊电器';
select * from dim_brand where brand_name like '%小熊电器';
select * from dim_brand where brand_name like '%小熊电器%';
select * from dim_brand where brand_name like '%小熊电';
select * from dim_brand where brand_name like '%小熊电;
select * from dim_brand where brand_name like '%小熊%';
show tables;
desc dim_sku;
select category_lvl1_name from dim_sku where brand_name='小熊';
select category_lvl1_name from dim_sku where brand_name='小熊' limit 5;
select category_lvl3_name from dim_sku where brand_name='小熊' limit 5;
select category_lvl3_id from dim_sku where brand_name='小熊' limit 5;
select category_lvl1_id from dim_sku where brand_name='小熊' limit 5;
drop table if exists meitun_tmp.tmp_lwq_xiaoxiong_cust2;
create table meitun_tmp.tmp_lwq_xiaoxiong_cust2 as SELECT distinct t.meitun_user_id FROM meitun_dw.sale_order_pay_detail t WHERE t.date_id >= '2016-07-01' AND t.date_id < '2017-01-18' adfsdgg;
desc babytree_enc_user_id;
desc user_profile_full;
select babytree_user_id from user_profile_full limit 10;
desc tmp.t_181416;
desc dim_user;
desc babytree.user;
use meitun_dw;
with spd as ( select sku_id, category_lvl3_id, order_amt from meitun_dw.sale_order_pay_detail where dt='2017-01-18' ), hc as ( select category_lvl3_id from meitun_dw.hier_category where category_lvl1_id=702 ), ds as ( select sku_id from meitun_dw.dim_sku where category_lvl1_id=702 ) select sum(case when hc.category_lvl3_id is not null then spd.order_amt end), sum(case when ds.sku_id is not null then spd.order_amt end) from spd left join hc using(category_lvl3_id) left join ds on ds.sku_id=spd.sku_id;
use meitun_dw;
use default;
select count(1) from appcontentclicklog_gz where dt='2017-01-19';
select count(id) from appcontentclicklog_gz where dt='2017-01-19';
use meitun_dw;
show tables;
desc init_sale_order_pay_detail;
desc dim_ipadress_location;
desc dim_supplier;
select supplier_id,supplier_name,status from dim_supplier where supplier_name like '深圳霓朵%';
select supplier_id,parent_supplier_id,supplier_name,status from dim_supplier where supplier_name like '深圳霓朵%';
select supplier_id,parent_supplier_id,supplier_type,status from dim_supplier where supplier_name like '深圳霓朵%';
select supplier_id,supplier_name,supplier_type,status from dim_supplier where supplier_name like '深圳霓朵%';
select supplier_id,supplier_name,supplier_type,status,waves_flag from dim_supplier where supplier_name like '深圳霓朵%';
select * from dim_supplier where supplier_name like '深圳霓朵%';
use meitun_dw;
select distinct level_code from user_grade_score;
desc tmp.t_031702;
use babytree;
select title from discussion_title where discussion_id=69563089 and dt='2017-01-20' limit 5;
select from_unixtime(1483200000);
use meitun_dw;
show tables;
desc sale_cust_first_order;
use babytree;
select count(id) from babyboxapplyuserservice;
select count(1) from babyboxapplyuserservice;
select count(1) from babyboxapplyuser;
select max(dt) from babyboxapplyuser;
use ods;
select enc_user_id from ods.coupon_user where batch_id=5065 limit 5;
select to_user_mobile from ods.coupon_user where batch_id=5065 limit 5;
use dw;
desc tmp.t_071937;
with cu as ( select batch_id coupon_id, enc_user_id babytree_enc_user_id, to_user_id meitun_user_id from ods.coupon_user where batch_id is not null and batch_id=5065 ), u as ( select meitun_user_id, babytree_enc_user_id from dw.dim_user where uid_valid_flag=1 ), temp as (select 1) select distinct case when cu.babytree_enc_user_id is not null then cu.babytree_enc_user_id else u.babytree_enc_user_id end babytree_enc_user_id from cu left join u on cu.meitun_user_id=u.meitun_user_id limit 100;
select length('str');
with cu as ( select batch_id coupon_id, enc_user_id babytree_enc_user_id, to_user_id meitun_user_id from ods.coupon_user where batch_id is not null and batch_id=5065 ), u as ( select meitun_user_id, babytree_enc_user_id from dw.dim_user where uid_valid_flag=1 ), temp as (select 1) select distinct case when cu.babytree_enc_user_id is not null and and length(cu.babytree_enc_user_id)>0 then cu.babytree_enc_user_id else u.babytree_enc_user_id end babytree_enc_user_id from cu left join u on cu.meitun_user_id=u.meitun_user_id limit 100;
with cu as ( select batch_id coupon_id, enc_user_id babytree_enc_user_id, to_user_id meitun_user_id from ods.coupon_user where batch_id is not null and batch_id=5065 ), u as ( select meitun_user_id, babytree_enc_user_id from dw.dim_user where uid_valid_flag=1 ), temp as (select 1) select distinct case when cu.babytree_enc_user_id is not null and length(cu.babytree_enc_user_id)>0 then cu.babytree_enc_user_id else u.babytree_enc_user_id end babytree_enc_user_id from cu left join u on cu.meitun_user_id=u.meitun_user_id limit 100;
use babytree;
select * from feed where dt='2017-02-07' limit 1\G
SHOW CATALOGS;
show tables from mt_4406;
show SCHEMAS from mt_4406;
show tables from mt_4406.comments;
desc mt_4406.comments.com_custom_question;
use ods;
show tables;
use dw;
show tables;
desc dim_sku;
use dw;
select count(1) from sale_reject_order_detail;
select distinct reject_reason from sale_reject_order_detail;
select count(1) from sale_reject_order;
use dw;
show tables;
use ods;
show tables;
select count(1) from so_order_line_datax where sku_code='07020100040201';
select count(1) from so_order_line_datax where sku_code='07020100040201' and create_time>='2017-03-27';
select max(prod_name), count(distinct sol.member_id), count(distinct sol.order_id), sum(sol.quantity), sum(sol.original_sub_total), sum(sol.sub_total) from ods.so_order_line_datax sol join ods.so_sub_order_datax sso on sol.sub_order_id=sso.id join dw.dim_sku ds on sol.sku_code=ds.sku_code where pay_code is not null and sol.sku_code='07020100040201' and pay_time>='2017-03-27' and pay_time<'2017-03-27 08:00:00' and ds.sku_code='07020100040201';
select --max(prod_name),
count(distinct sol.member_id), count(distinct sol.order_id), sum(sol.quantity), sum(sol.original_sub_total), sum(sol.sub_total) from ods.so_order_line_datax sol join ods.so_sub_order_datax sso on sol.sub_order_id=sso.id join dw.dim_sku ds on sol.sku_code=ds.sku_code where pay_code is not null and sol.sku_code='07020100040201' and pay_time>='2017-03-27' and pay_time<'2017-03-27 08:00:00' and ds.sku_code='07020100040201';
use dw;
select count(1) from dim_supplier where status=1;
SELECT sub_order_code, order_status, pay_time, order_create_time FROM dw.sale_sub_order WHERE sub_order_code in ('11170328040397250','11170328040382097','11170328040400486','11170328040400536') and dt>='2017-01-01';
SELECT sub_order_code, order_status, pay_time, order_create_time,dt FROM dw.sale_sub_order WHERE sub_order_code in ('11170328040397250','11170328040382097','11170328040400486','11170328040400536') and dt>='2017-01-01';
desc sale_order_pay_detail;
SELECT ds.sku_code, spd.dt, sum(order_amt) FROM dw.sale_sub_order sso join sale_order_pay_detail spd using(sub_order_id) join dim_sku ds on ds.sku_id=spd.sku_id WHERE sub_order_code in ('11170328040397250','11170328040382097','11170328040400486','11170328040400536') and sso.dt>='2017-01-01' and spd.dt>='2017-01-01';
SELECT ds.sku_code, spd.dt, sum(spd.order_amt) FROM dw.sale_sub_order sso join dw.sale_order_pay_detail spd using(sub_order_id) join dw.dim_sku ds on ds.sku_id=spd.sku_id WHERE sub_order_code in ('11170328040397250','11170328040382097','11170328040400486','11170328040400536') and sso.dt>='2017-01-01' and spd.dt>='2017-01-01';
SELECT ds.sku_code, spd.dt, sum(spd.order_amt) FROM dw.sale_sub_order sso join dw.sale_order_pay_detail spd using(sub_order_id) join dw.dim_sku ds on ds.sku_id=spd.sku_id WHERE sub_order_code in ('11170328040397250','11170328040382097','11170328040400486','11170328040400536') and sso.dt>='2017-01-01' and spd.dt>='2017-01-01' group by 1,2;
SELECT ds.sku_code, spd.dt, sum(spd.order_amt) FROM dw.sale_sub_order sso join dw.sale_order_pay_detail spd using(sub_order_id) left join dw.dim_sku ds on ds.sku_id=spd.sku_id WHERE sub_order_code in ('11170328040397250','11170328040382097','11170328040400486','11170328040400536') and sso.dt>='2017-01-01' and spd.dt>='2017-01-01' group by 1,2;
SELECT ds.sku_code, spd.dt, sum(spd.order_amt), sum(sso.order_amt) FROM dw.sale_sub_order sso left join dw.sale_order_pay_detail spd using(sub_order_id) left join dw.dim_sku ds on ds.sku_id=spd.sku_id WHERE sub_order_code in ('11170328040397250','11170328040382097','11170328040400486','11170328040400536') and sso.dt>='2017-01-01' and spd.dt>='2017-01-01' group by 1,2;
SELECT sub_order_code, sso.dt, spd.dt, sum(spd.order_amt), sum(sso.order_amt) FROM dw.sale_sub_order sso left join dw.sale_order_pay_detail spd using(sub_order_id) left join dw.dim_sku ds on ds.sku_id=spd.sku_id WHERE sub_order_code in ('11170328040397250','11170328040382097','11170328040400486','11170328040400536') group by 1,2,3;
use ods;
select audit_status, count(id) from sp_contract group by 1;
select current_date();
select current_date;
use ods;
show tables;
select * from sp_contract_product where brand_id is null;
select * from sp_contract_product where category_lvl1_id is null;
use meitun;
show tables;
desc m_sourceubtpageview;
use meitun;
select count(1) from m_sourceubtpageview where trackercode='huishi_myzy' and dt='2017-04-01';
use dw;
select * from dim_page_position where remark like '%奶粉%';
select * from dim_page_position limit 50;
select * from dim_page_position limit 10\G
select * from dim_page_position where ele_name like '%奶粉%';
select * from dim_page_position where ele_name like '%奶粉频道;
select * from dim_page_position where ele_name like '%奶粉频道%‘;
select * from dim_page_position where ele_name like '%奶粉频道%';
show tables;
select count(distinct supplier_id) from mt_4409.supplier.sp_supplier_user where status=1;
select count(distinct supplier_id) from mt_4409.supplier.sp_supplier_user where status='true';
use dw;
show tables;
desc dim_page_position;
select * from dim_page_position where trackercode like 'mikchannel_carousel_%'\G
select * from dim_page_position where trackercode='mikchannel_carousel_1;
select * from dim_page_position where trackercode='mikchannel_carousel_1';
use meitun;
show tables;
select * from dim_page_position where ele_name like '%轮播%';
select * from dw.dim_page_position where ele_name like '%轮播%';
use dw;
select meitun_user_id from sale_cust_first_order where first_pay_order_date_id='2017-04-06' limit 5\G
use dw;
select count(distinct enc_user_id) from user_blacklist;
select count(1) from user_blacklist;
select count(1) from babytree.lamayunxinchannel;
use dw;
select count(distinct supplier_id) from dim_sku where status=1;
use dw;
select count(distinct enc_user_id) from user_blacklist where black_type<>5;
use metiun;
select count(1) from meitun.m_sourceubtpageview where dt='2017-04-14' and sourcetype='btm-android' and yversion='7.0.10';
use dw;
desc dim_spu;
use dw;
select brand_id where brand_name='倍康';
select brand_id from dim_brand where brand_name='倍康';
use ods;
select content from ods.discussion where dt='2017-04-17' limit 10\G
select count(1) from ods.discussion where dt='2017-04-17';
select count(1) from ods.discussionresponse where dt='2017-04-17';
select content from ods.discussionresponse where dt='2017-04-17' limit 10\G
select content from ods.discussionresponse where dt='2017-04-17' and content like '%moony%' limit 10\G
select count(distinct sub_order_id),count(1) from tmp.appbug001;
desc tmp.appbug001;
use dw;
select * from user_meitun_device limit 10\G
desc user_imp_survey_label_data;
desc user_consignee_pairs;
desc user_babytree_device;
desc user_babytree_journey;
select date_diff(hour, timestamp '2016-10-01', timestamp '2016-10-02');
select date_diff('hour', timestamp '2016-10-01', timestamp '2016-10-02');
use dw;
select case when express_time is not null and date_diff('hour',date_p arse(approve_time, '%Y-%m-%d %T') , date_parse(express_time, '%Y-%m-%d %T') )<=72 then sub_order_id end from sale_sub_order where dt='2017-01-01';
select case when express_time is not null and date_diff('hour',date_parse(approve_time, '%Y-%m-%d %T') , date_parse(express_time, '%Y-%m-%d %T') )<=72 then sub_order_id end from sale_sub_order where dt='2017-01-01' limit 10;
select case when express_time is not null and date_diff('hour',approve_time, express_ttime)<=72 then sub_order_id end from sale_sub_order where dt='2017-01-01' limit 10;
select case when express_time is not null and date_diff('hour',approve_time, express_time)<=72 then sub_order_id end from sale_sub_order where dt='2017-01-01' limit 10;
select express_time from sale_sub_order where dt='2017-01-01' limit 10;
select express_time from sale_sub_order where dt='2017-01-01' and express_time is not null limit 10;
select approve_time from sale_sub_order where dt='2017-01-01' and express_time is not null limit 10;
select case when express_time is not null and date_diff('hour',date_parse(approve_time, '%Y%m%d%T') , date_parse(express_time, '%Y%m%d%T') )<=72 then sub_order_id end from sale_sub_order where dt='2017-01-01' limit 10;
select case when express_time is not null and date_diff('hour',date_parse(cast(approve_time as string), '%Y%m%d%T') , date_parse(cast(express_time as string), '%Y%m%d%T'))<=72 then sub_order_id end from sale_sub_order where dt='2017-01-01' limit 10;
select case when express_time is not null and date_diff('hour',date_parse(cast(approve_time as varchar), '%Y%m%d%T') , date_parse(cast(express_time as varchar), '%Y%m%d%T'))<=72 then sub_order_id end from sale_sub_order where dt='2017-01-01' limit 10;
select case when express_time is not null and date_diff('hour',date_parse(cast(approve_time as varchar), '%Y%m%d%H%i%s') , date_parse(cast(express_time as varchar), '%Y%m%d%H%i%s'))<=72 then sub_order_id end) from sale_sub_order where dt='2017-01-01' limit 10;
select case when express_time is not null and date_diff('hour',date_parse(cast(approve_time as varchar), '%Y%m%d%H%i%s') , date_parse(cast(express_time as varchar), '%Y%m%d%H%i%s'))<=72 then sub_order_id end from sale_sub_order where dt='2017-01-01' limit 10;
select date_parse(cast(approve_time as varchar), '%Y%m%d%H%i%s') from sale_sub_order where dt='2017-01-01' limit 10;
select date_diff('hour',date_parse(cast(approve_time as varchar), '%Y%m%d%H%i%s'),date_parse(cast(delivered_time as varchar) from sale_sub_order where dt='2017-01-01' limit 10;
select date_diff('hour',date_parse(cast(approve_time as varchar), '%Y%m%d%H%i%s'),date_parse(cast(delivered_time as varchar),'%Y%m%d%H%i%s')) from sale_sub_order where dt='2017-01-01' limit 10;
select date_diff('hour',date_parse(cast(approve_time as varchar), '%Y%m%d%H%i%s'),date_parse(cast(delivered_time as varchar),'%Y-%m-%d %H:%i:%s')) from sale_sub_order where dt='2017-01-01' limit 10;
use dw;
count(distinct case when date_diff('hour',date_parse(cast(approve_time as varchar), '%Y%m%d%H%i%s') , date_parse(delivered_time, '%Y-%m-%d %H:%i:%s'))<=48 then sub_ order_id end) 48y,;
select date_diff('hour',date_parse(cast(approve_time as varchar), '%Y%m%d%H%i%s') , date_parse(delivered_time, '%Y-%m-%d %H:%i:%s') from sale_sub_order where dt='2017-01-01' limit 5;
select date_diff('hour',date_parse(cast(approve_time as varchar), '%Y%m%d%H%i%s') , date_parse(delivered_time, '%Y-%m-%d %H:%i:%s')) from sale_sub_order where dt='2017-01-01' limit 5;
select date_diff('hour',date_parse(cast(approve_time as varchar), '%Y%m%d%H%i%s') , date_parse(delivered_time, '%Y-%m-%d %H:%i:%s')) from sale_sub_order where approve_time is not null and dt='2017-01-01' limit 5;
select date_diff('hour',date_parse(cast(approve_time as varchar), '%Y%m%d%H%i%s') , date_parse(delivered_time, '%Y-%m-%d %H:%i:%s')) from sale_sub_order where approve_status=1 and dt='2017-01-01' limit 5;
select case when date_diff('hour',date_parse(cast(approve_time as varchar), '%Y%m%d%H%i%s') , date_parse(delivered_time, '%Y-%m-%d %H:%i:%s'))<=24 then 1 else 0 end from sale_sub_order where approve_status=1 and dt='2017-01-01' limit 5;
select case when date_diff('hour',date_parse(cast(approve_time as varchar), '%Y%m%d%H%i%s') , date_parse(delivered_time, '%Y-%m-%d %H:%i:%s'))<=24 then sub_order_id else 0 end from sale_sub_order where approve_status=1 and dt='2017-01-01' limit 5;
select count(distinct case when date_diff('hour',date_parse(cast(approve_time as varchar), '%Y%m%d%H%i%s') , date_parse(delivered_time, '%Y-%m-%d %H:%i:%s'))<=24 then sub_order_id end) from sale_sub_order where approve_status=1 and dt='2017-01-01' limit 5;
use dw;
select count(distinct case when date_diff('hour',date_parse(cast(approve_time as varchar), '%Y%m%d%H%i%s') , date_parse(delivered_time, '%Y-%m-%d %H:%i:%s'))<=48 from sale_sub_order where approve_status=1 and dt='2017-01-01' limit 5;
select count(distinct case when date_diff('hour',date_parse(cast(approve_time as varchar), '%Y%m%d%H%i%s') , date_parse(delivered_time, '%Y-%m-%d %H:%i:%s'))<=48 then sub_order_id end) from sale_sub_order where approve_status=1 and dt='2017-01-01' limit 5;
use dw;
show tables;
desc user_info;
desc user_regist_info;
select count(1) from user_info;
select count(1) from dim_user;
use dw;
select dt,approve_time,express_time,delivered_time from sale_sub_order where sub_order_code='11170424042462095' and dt>='2017-04-01';
use ods;
select id,code,status,express_time from sale_sub_order where code='11170424042462095';
select id,code,status,express_time from so_sub_order where code='11170424042462095';
use ods;
select id,code,status,express_time from so_sub_order where code='11170425042546614';
use dw;
select express_time from sale_sub_order where sub_order_code='11170424042461151' and dt='2017-04-24';
use dw;
use ods;
select express_time,approve_time from so_sub_order where code='11170501042874288';
select express_time,approve_time from so_sub_order where code='11170501042898428';
select express_time,delivered_time,approve_time from so_sub_order where code='11170501042898428';
select express_time,delivered_time,approve_time,supplier_id from so_sub_order where code='11170501042898428';
use dw;
select date_diff(hour,timestamp'2017-05-01',timestamp'2017-05-04');
select date_diff('hour',timestamp'2017-05-01',timestamp'2017-05-04');
select sub_order_code,approve_time,delivered_time from sale_sub_order where dt='2017-05-01' and approve_status=1 and delivered_time is null;
use inf;
select count(1) from inf_seller_order_send_detail where is_send=0 and date_id='2017-05-01';
select delivered_time from inf_seller_order_send_detail where is_send=0 and date_id='2017-05-01';
select delivered_time from inf_seller_order_send_detail where is_send=0 and date_id='2017-05-16';
select delivered_time from inf_seller_order_send_detail where is_send=0 and date_id='2017-05-15';
select count(distinct sub_order_code) from inf_seller_order_send_detail where is_send=0 and date_id='2017-05-15';
use ods;
show tables;
use inf;
select supplier_name,delivered_time from inf_seller_order_send_detail where is_send=0 and date_id='2017-05-15';
select supplier_name,delivered_time from inf_seller_order_send_detail where is_send=0 and date_id='2017-05-15' and parent_order_type=1;
select supplier_name,order_create_time,delivered_time from inf_seller_order_send_detail where is_send=0 and date_id='2017-05-15';
select supplier_name,order_create_time,delivered_time from inf_seller_order_send_detail where is_send=0 and date_id='2017-05-15' and parent_order_type=1;
select supplier_name,order_create_time,delivered_time from inf_seller_order_send_detail where is_send=0 and date_id='2017-05-01' and parent_order_type=1 and supplier_name='海普诺凯营养品有限公司';
select supplier_name,order_create_time,delivered_time from inf_seller_order_send_detail where is_send=0 and date_id='2017-05-02' and parent_order_type=1 and supplier_name='海普诺凯营养品有限公司';
select supplier_name,order_create_time,delivered_time from inf_seller_order_send_detail where is_send=0 and delivered_time<'2000-01-01' and parent_order_type=1 and supplier_name='海普诺凯营养品有限公司';
select supplier_name,order_create_time,delivered_time from inf_seller_order_send_detail where is_send=0 and delivered_time<'2000-01-01' and parent_order_type=1;
use meitun;
show tables;
use dw;
use meitun;
use dw;
select uid from user_grade_score where enc_user_id='u16099387512' and dt='2017-05-15';
select enc_user_id from user_grade_score where enc_user_id='u16099387512' and dt='2017-05-15';
select * from user_blacklist enc_user_id='u16099387512';
select * from user_blacklist where enc_user_id='u16099387512';
select black_desc from user_blacklist where enc_user_id='u16099387512';
use babytree;
select clientid from userappclientidmaptotal limit 1;
select device_id,device_type,source_type from dw.user_meitun_device where dt='2017-05-01' where device_type>2 limit 5;
select device_id,device_type,source_type from dw.user_meitun_device where dt='2017-05-01' and device_type>2 limit 5;
select device_id,device_type,source_type from dw.user_meitun_device where dt='2017-05-01' and device_type=0 limit 5;
select device_id,device_type,source_type from dw.user_meitun_device where dt='2017-05-01' and source_type='btm-android' limit 5;
select device_id,device_type,source_type from dw.user_meitun_device where dt='2017-05-01' and device_type=1 limit 5;
use ods;
use babytree;
select distinct client_version from userappclientidmaptotal limit 10;
select max(client_version) from userappclientidmaptotal limit 10;
use tmp;
select * from ods.so_kuaidi100_express where dt='2017-05-01' limit 2\G
select * from ods.so_kuaidi100_express where dt>='2017-05-01' and sub_order_code='11170502042944536'\G
select * from ods.so_kuaidi100_express where dt>='2017-04-15' and sub_order_code='11170501042874288'\G
select * from ods.so_kuaidi100_express where dt>='2017-04-15' and sub_order_code='11170430042810746'\G
select * from ods.so_kuaidi100_express where dt>='2017-04-25' and dt <='2017-05-05' and sub_order_code='11170430042810746' order by create_time\G
select package_no,count(distinct package_no) from ods.so_kuaidi100_express where dt>='2017-05-01' gorup by 1 having count(distinct package_no)>1 limit 10;
select count(1) from (select package_no from ods.so_kuaidi100_express where dt>='2017-05-01' gorup by 1 having count(distinct package_no)>1);
select count(1) from (select package_no from ods.so_kuaidi100_express where dt>='2017-05-01' gorup by 1 having count(distinct sub_order_code)>1);
select count(1) from (select package_no from ods.so_kuaidi100_express where dt>='2017-05-01' group by 1 having count(distinct sub_order_code)>1);
select count(1) from (select package_no from ods.so_kuaidi100_express where dt>='2017-05-01' group by 1 having count(distinct sub_order_code)>2);
select package_no from ods.so_kuaidi100_express where dt>='2017-05-01' group by 1 having count(distinct sub_order_code)>1 limit 10;
select count(1) from (select company_id,package_no from ods.so_kuaidi100_express where dt>='2017-05-01' group by 1,2 having count(distinct sub_order_code)>1);
select company_id,package_no from ods.so_kuaidi100_express where dt>='2017-05-01' group by 1,2 having count(distinct sub_order_code)>1;
company_id | package_no;
select * from so_kuaidi100_express where company_id='huitongkuaidi' and dt>='2017-05-01' and package_no='70901704081979'\G
select * from so_kuaidi100_express where company_id='huitongkuaidi' and dt>='2017-05-01' and package_no='70901704081979'/G;
select * from ods.so_kuaidi100_express where company_id='huitongkuaidi' and dt>='2017-05-01' and package_no='70901704081979'/G;
select * from ods.so_kuaidi100_express where company_id='huitongkuaidi' and dt>='2017-05-01' and package_no='70901704081979'\G
select * from dw.sale_sub_order where sub_order_code in ('11170519044187596','11170519044187658') and dt>=2017-05-15\G
select * from dw.sale_sub_order where sub_order_code in ('11170519044187596','11170519044187658') and dt>='2017-05-15'\G
select * from ods.so_kuaidi100_express where company_id='huitongkuaidi' and dt>='2017-05-01' and package_no='439641988621'\G
select * from ods.so_kuaidi100_express where company_id='zhongtong' and dt>='2017-05-01' and package_no='439641988621'\G
select * from dw.sale_sub_order where sub_order_code in ('11170525044719509','11170525044719347') and dt>='2017-05-15'\G
select * from ods.so_kuaidi100_express where company_id='shentong' and dt>='2017-05-01' and package_no='3328552796737'\G
select * from dw.sale_sub_order where sub_order_code in ('11170504043088745','11170504043088755') and dt>='2017-05-15'\G
select * from dw.sale_sub_order where sub_order_code in ('11170504043088745','11170504043088755') and dt>='2017-05-01' and dt<='2017-05-15'\G
select * from ods.so_kuaidi100_express where company_id='youzhengguonei' and dt>='2017-05-01' and package_no='9640117214936'\G
select * from dw.sale_sub_order where sub_order_code in ('11170513043730631','11170513043730790') and dt>='2017-05-05' and dt<='2017-05-20'\G
select count(distinct sub_order_id) from dw.sale_sub_order where dt>='2017-05-17' and express_time<pay_time;
select count(distinct sub_order_id) from dw.sale_sub_order where dt>='2017-05-17' and cast(date_parse(express_time,'%Y%m%d%H%i%s) as varchar)<pay_time;
select count(distinct sub_order_id) from dw.sale_sub_order where dt>='2017-05-17' and cast(date_parse(express_time,'%Y%m%d%H%i%s') as varchar)<pay_time;
select count(distinct sub_order_id) from dw.sale_sub_order where dt>='2017-05-17' and cast(date_parse(cast(express_time as varchar),'%Y%m%d%H%i%s') as varchar)<pay_time;
select count(distinct sub_order_id) from dw.sale_sub_order where dt>='2017-05-17' and length(cast(express_time as varchar))=14 and cast(date_parse(cast(express_time as varchar),'%Y%m%d%H%i%s') as varchar)<pay_time;
select distinct express_time,pay_time from dw.sale_sub_order where dt>='2017-05-17' and length(cast(express_time as varchar))=14 and cast(date_parse(cast(express_time as varchar),'%Y%m%d%H%i%s') as varchar)<pay_time;
select distinct sub_order_code,express_time,pay_time from dw.sale_sub_order where dt>='2017-05-17' and length(cast(express_time as varchar))=14 and cast(date_parse(cast(express_time as varchar),'%Y%m%d%H%i%s') as varchar)<pay_time;
select count(distinct sub_order_id) from dw.sale_sub_order where dt>='2017-05-17' and length(cast(express_time as varchar))=14;
select * from ods.so_kuaidi100_express where dt<'2017-05-01' and dt>='2017-04-01' and package_no='9890654927764'\G
select distinct company_id from ods.so_kuaidi100_express and dt>='2017-04-01 and dt<'2017-05-01';
select distinct company_id from ods.so_kuaidi100_express and dt>='2017-04-01' and dt<'2017-05-01';
select distinct company_id from ods.so_kuaidi100_express where dt>='2017-04-01' and dt<'2017-05-01';
select name,be.code from (select distinct company_id from ods.so_kuaidi100_express where dt>='2017-04-01' and dt<'2017-05-01') b join ods.base_express_info be on be.code=b.company_id;
select name,code from ods.base_express_info where name='广州邮政';
select name,code from ods.base_express_info where name='东州邮政';
select name,code from ods.base_express_info where name='广东邮政';
select name,be.code from (select distinct company_id from ods.so_kuaidi100_express where dt>='2017-05-01' and dt<'2017-06-01') b join ods.base_express_info be on be.code=b.company_id;
use ods;
use dw;
select * from ods.so_kuaidi100_express where package_no='3101267123823' and dt>='2017-05-01' and dt<'2017-05-31';
select name from ods.base_express_info a join (select distinct company_id from ods.so_kuaidi100_express where dt>='2017-05-01' and dt<'2017-05-31') b on a.id=b.company_id;
select name from ods.base_express_info a join (select distinct company_id from ods.so_kuaidi100_express where dt>='2017-05-01' and dt<'2017-05-31') b on a.code=b.company_id;
select name from ods.base_express_info where name like '%韵达快运%';
use dw;
select sum(order_amt) from sale_order_pay_detail where dt='2017-05-24';
use dw;
select sum(order_net_amt) from sale_sub_order where order_status<>0 and pay_code is not null and approve_status=1 and pay_time>='2017-05-24 10:00:00' and pay_time<='2017-05-27 10:00:00' and parent_order_code='10170526035183288';
select sum(order_net_amt) from sale_sub_order where order_status<>0 and pay_code is not null and approve_status=1 and pay_time>='2017-05-24 10:00:00' and pay_time<='2017-05-27 10:00:00' and dt>='2017-05-24' and dt<'2017-05-28'and parent_order_code='10170526035183288';
select * from dim_user where babytree_enc_user_id='u156808036760';
select * from dim_user where babytree_enc_user_id='u156808036760'\G
use dw;
select * from sale_order_pay_detail where babytree_enc_user_id='u166254244158' and dt>='2017-05-24'\G
select * from sale_sub_order where babytree_enc_user_id='u166254244158' and dt>='2017-05-24'\G
select babytree_enc_user_id,parent_order_id,sum(order_net_amt) from sale_sub_order where babytree_enc_user_id in ('u166254244158','u57757790383','u10717379641') and dt>='2017-05-24' and dt<'2017-05-28' group by 1,2\G
select babytree_enc_user_id,parent_order_id,sum(order_net_amt) from sale_sub_order where babytree_enc_user_id in ('u166254244158','u57757790383','u10717379641') and dt>='2017-05-24' and dt<'2017-05-28' group by 1,2 order by 1,2\G
select babytree_enc_user_id,parent_order_id,sum(order_net_amt) order_net_amt from sale_sub_order where babytree_enc_user_id in ('u166254244158','u57757790383','u10717379641') and order_status<>0 and dt>='2017-05-24' and dt<'2017-05-28' group by 1,2 order by 1,2\G
select babytree_enc_user_id,parent_order_id,sum(order_net_amt) order_net_amt from sale_sub_order where babytree_enc_user_id in ('u166254244158','u57757790383','u10717379641') and order_status<>0 and approve_status=1 and dt>='2017-05-24' and dt<'2017-05-28' group by 1,2 order by 1,2\G
select babytree_enc_user_id,parent_order_id,sum(order_net_amt) order_net_amt from sale_sub_order where babytree_enc_user_id in ('u166254244158','u57757790383','u10717379641') and order_status<>0 and approve_status=1 and dt>='2017-05-24' and dt<'2017-05-28' and pay_time>='2017-05-24 10:00:00' and pay_time<'2017-05-27 10:00:00' group by 1,2 order by 1,2\G
use dw;
select distinct babytree_enc_user_id from sale_sub_order where dt>='2017-05-24' and dt<'2017-05-28' and parent_order_id='10170524034897999';
select distinct babytree_enc_user_id from sale_sub_order where dt>='2017-05-24' and dt<'2017-05-28' and parent_order_id=10170524034897999;
select * from dim_user where babytree_enc_user_id='u57757790383';
select * from dim_user where babytree_enc_user_id='u57757790383'\G
use dw;
select * from ods.pr_activity_single_ral where promotion_id='334658' limit 10;
select * from ods.pr_activity_single_ral where promotion_id=334658 limit 10;
select * from ods.pr_activity_single_ral where promotion_id='1631534' limit 10;
select * from ods.pr_activity_single_ral where promotion_id=1631534 limit 10\G
select * from ods.pr_activity_single_ral where promotion_id=835748 limit 10\G
select * from ods.pr_activity_single_ral where id=835748 limit 10\G
desc sale_sub_order;
select count(1) from dw.sale_sub_order where dt>='2017-06-01' and length(babytree_enc_user_id)>0;
select count(1) from dw.sale_sub_order where dt>='2017-06-01' and length(babytree_enc_user_id)=0;
select count(1) from dw.dim_user where length(babytree_enc_user_id)=0;
select count(1) from dw.dim_user where babytree_enc_user_id is null;
select count(1) from dw.dim_user where uid_valid_flag=1 and babytree_enc_user_id is null;
select count(1) from dw.dim_user where uid_valid_flag=1 and length(babytree_enc_user_id)=0;
select * from dw.dim_user where uid_valid_flag=1 and length(babytree_enc_user_id)=0;
select * from dw.dim_user where uid_valid_flag=1 and babytree_enc_user_id is null;
select * from dw.dim_user where uid_valid_flag=1 and babytree_enc_user_id is null\G
select * from dw.dim_user where uid_valid_flag=1 and length(babytree_enc_user_id)=0\G
use dw;
use ods;
select count(1) from pr_activity_single_ral where promotion_id='120842';
select count(1) from pr_activity_single_ral where promotion_id=120842;
select count(1) from pr_activity_single_ral where id=120842;
select count(1) from pr_activity_single_ral where topic_id=120842;
use dw;
use ods;
select count(1) from (select promotion_id from pr_activity_single_ral group by 1 having count(distinct spu)>1);
use dm_seller;
select count(distinct supplier_id) from seller_store_dsr;
select count(distinct supplier_id) from seller_store_dsr where date_id>='2017-06-01';
use dw;
use ods;
select sku,topic_id,count(1) from pr_topic_item where approve_status=0 group by 1,2 having count(1)>1 order by 3 desc;
select sku,topic_id,count(1) from pr_topic_item where approve_status=0 and deletion=0 and is_test=0 and mt_subsidy_amount>0 group by 1,2 having count(1)>1 order by 3 desc;
select * from pr_activity_base where id=4176\g
select * from pr_activity_group_user where id=4176\g
select * from pr_activity_group_user where activity_id=4176\g
select * from pr_activity_group_user where group_instance_id=4176\g
select * from pr_activity_base where name like '亲润 樱花%'\g
select * from pr_activity_base where name like '亲润 樱花%'/G;
select * from pr_activity_base where name like '亲润 樱花%'\G
use dw;
select count(1) from m_sourceubtpageview_gz where dt>='2017-06-13' and split_part(href,'=',2) like 'cms_7_draw%';
select count(1) from meitun.m_sourceubtpageview_gz where dt>='2017-06-13' and split_part(href,'=',2) like 'cms_7_draw%';
select count(1) from meitun.m_sourceubtpageview_gz where dt>='2017-06-13' and split_part(href,':',2) like 'pageid=cms_7_draw%';
select count(1) from meitun.m_sourceubtpageview_gz where dt>='2017-06-13' and href like '%pageid=cms_7_draw%';
select count(1) from meitun.m_sourceubtpageview_gz where dt>='2017-06-13' and href like '%cms_7_draw%';
select count(1) from meitun.m_sourceubtpageview_gz where dt>='2017-06-13' and url like '%cms_7_draw%';
select count(1) from meitun.m_sourceubtpageview_gz where dt>='2017-06-13' and trackercode like '%cms_7_draw%';
select * from dim_sku where spu_id=0602010073;
select * from dim_sku where substr(spu_code,1,10)='0602010073';
select * from dim_sku where substr(sku_code,1,10)='0602010073';
select * from dim_sku where activity_id=1698 and spu='0602010073';
select * from ods.pr_activity_item where activity_id=1698 and spu='0602010073';
select * from ods.pr_activity_item where activity_id=1698;
select * from ods.pr_activity_item where spu=0602010073;
use dw;
use meitun;
select count(1) from m_sourceubtpageview_gz where dt>='2017-06-13' and trackercode='cms_7_draw';
use dw;
select * from sale_cust_first_order where babytree_enc_user_id='u809521382636';
select * from sale_cust_first_order where babytree_enc_user_id='u809521382636'\G
use dw;
select max(index) from tmp.sxli_seo_keyword;
select * from tmp.sxli_seo_keyword;
use dw;
select distinct waves_flag from dim_supplier;
select waves_flag,count(1) from dim_supplier group by 1;
select count(1) from dim_sku where sku_code in ('06010105755701','06010105755601');
select distinct sku_id from dim_sku where sku_code in ('06010105755701','06010105755601');
select dt,topic_id,sku_id,count(1) from dim_sku where dt>='2017-06-15' and sku_id in ('102482','102481') group by 1,2,3;
select dt,topic_id,sku_id,count(1) from sale_order_pay_detail where dt>='2017-06-15' and sku_id in (102482,102481) group by 1,2,3;
use dw;
select * from tmp.t_231432;
desc tmp.t_231432;
select * from tmp.t_231432;
select * from tmp.t_231439;
select * from tmp.t_231453;
select count(1) from tmp.t_231453;
select count(1) from tmp.t_231453 where id is not null;
select id,count(1) from tmp.t_231453 where id is not null group by 1;
select key,count(distinct id) from tmp.t_231453 where id is not null group by 1 order by 2 desc limit 50;
select key,count(distinct id) from tmp.t_231453 where key is not null and length(key)>0 group by 1 order by 2 desc limit 50;
select key,count(distinct id) from tmp.t_231453 where key is not null and length(key)>0 and key not in (',','.') group by 1 order by 2 desc limit 50;
select key,count(distinct id) from tmp.t_231453 where key is not null and length(key)>0 and key not in (',',' ') group by 1 order by 2 desc limit 50;
select key,count(distinct id) from tmp.t_231453 where key is not null and length(key)>0 and key not in ('，',' '),'。') group by 1 order by 2 desc limit 50;
select key,count(distinct id) from tmp.t_231453 where key is not null and length(key)>0 and key not in ('，',' ')'。') group by 1 order by 2 desc limit 50;
select key,count(distinct id) from tmp.t_231453 where key is not null and length(key)>0 and key not in ('，',' ')',') group by 1 order by 2 desc limit 50;
select key,count(distinct id) from tmp.t_231453 where key is not null and length(key)>0 and key not in ('，',' '') group by 1 order by 2 desc limit 50;
select key,count(distinct id) from tmp.t_231453 where key is not null and length(key)>0 and key not in ('，',' '' group by 1 order by 2 desc limit 50;
select key,count(distinct id) from tmp.t_231453 where key is not null and length(key)>0 and key not in ('，',' '')group by 1 order by 2 desc limit 50;
select key,count(distinct id) from tmp.t_231453 where key is not null and length(key)>0 and key not in group by 1 order by 2 desc limit 50;
select key,count(distinct id) from tmp.t_231453 where key is not null and length(key)>0 and key not in (' ') group by 1 order by 2 desc limit 50;
select key,count(distinct id) from tmp.t_231453 where key is not null and length(key)>0 and key not in (' ','。',''，) group by 1 order by 2 desc limit 50;
select key,count(distinct id) from tmp.t_231453 where key is not null and length(key)>0 and key not in (' ','','') group by 1 order by 2 desc limit 50;
use dw;
select count(1) from tmp.fannian_comment_test2 where key is not null and length(key)>0 and key not in (' ');
select key,count(1) from tmp.fannian_comment_test2 where key is not null and length(key)>0 and key not in (' ') group by 1 order by 2 desc limit 50;
select key,count(1) from tmp.fannian_comment_test2 where key is not null and length(key)>0 and key not in (' ') group by 1 order by 2 desc limit 55;
select key,count(distinct id),count(1) from tmp.fannian_comment_test2 where key is not null and length(key)>0 and key not in (' ') group by 1 order by 2 desc limit 55;
select count(distinct id) from tmp.fannian_comment_test2 where key is not null and length(key)>0 and key not in (' ');
select count(1) from tmp.fannian_comment_test2 where key is not null and length(key)>0 and key not in (' ');
use ods;
select source_type,sum(discount) from so_order_promotion where create_time>='2017-06-22';
select source_type,sum(discount) from so_order_promotion where create_time>='2017-06-22' group by 1;
select source_type,sum(discount) from so_order_promotion where create_time>='2017-06-22' and create_time<'2017-06-23' group by 1;
su - fannian fn_daj&%az_8271;
use dw;
select count(1),count(distinct sku_id) from dim_sku;
select count(1) from sale_order_pay_detail where (sku_id is null or length(sku_id)=0) and dt>='2017-06-18';
select count(1) from sale_order_pay_detail where (sku_id is null or sku_id=0) and dt>='2017-06-18';
select count(1),count(distinct sku_id) from dim_sku where category_lvl1_name is null;
select count(1),count(distinct sku_id) from dim_sku where category_lvl1_name is null or category_lvl1_name like '%test%';
select count(1),count(distinct sku_id) from dim_sku where length(category_lvl1_name)=0;
select count(1),count(distinct sku_id) from dim_sku where category_lvl1_name not like '%作废%';
select count(1),count(distinct sku_id) from dim_sku where category_lvl1_name like '%作废%';
use dw;
select count(1),count(distinct sku_id),count(distinct barcode) from dim_sku;
select topic_id,sku,count(1) from ods.pr_topic_item where mt_subsidy_amount>0 group by 1,2;
select topic_id,sku,count(1) from ods.pr_topic_item where mt_subsidy_amount>0 group by 1,2 having count(1)>1;
select topic_id,sku,count(1) from ods.pr_topic_item where mt_subsidy_amount>0 and approve_status=0 group by 1,2 having count(1)>1;
select topic_id,sku,count(1) from ods.pr_topic_item where mt_subsidy_amount>0 and approve_status=0 and deletion=0 group by 1,2 having count(1)>1;
select distinct parent_order_id,sub_order_id from sale_order_pay_detail where dt='2017-06-24' and limit 10;
select distinct parent_order_id,sub_order_id from sale_order_pay_detail where dt='2017-06-24' limit 10;
select count(1) from dim_single_activity where single_activity_name like '%test%';
select count(1) from dim_single_activity where single_activity_name like '%作废%';
select count(1) from dim_single_activity where single_activity_name like '%测试%';
select cast(sku as bigint) sku from ods.pr_topic_item limit 10;
select cast(sku as bigint),sku from ods.pr_topic_item limit 10;
select count(1) from dim_single_activity where single_activity_name is null;
select distinct join_instances_id from sale_order_pay_detail where dt='2017-06-18' and promotion_type=5 limit 5;
select distinct join_instances_id from sale_order_pay_detail where dt='2017-06-18' and promotion_type<>5 limit 5;
select distinct group_id from sale_order_pay_detail where dt='2017-06-18' and promotion_type<>5 limit 5;
select distinct group_id from sale_order_pay_detail where dt='2017-06-18' and promotion_type=5 limit 5;
select promotion_type,count(1) from sale_order_pay_detail where dt='2017-06-18' group by 1;
select count(distinct parent_order_id) from sale_order_pay_detail where dt='2017-06-24' and topic_id is null;
select count(distinct order_line_id),count(1) from sale_order_pay_detail where dt='2017-06-24';
select count(1) from dim_topic where topic_name like '%test%';
select count(1) from dim_sku where brand_name like '%test%';
select count(1) from dim_sku where category_lvl2_name like '%test%';
select count(1) from dim_sku where category_lvl3_name like '%test%';
select count(1) from dim_sku where prod_name like '%test%';
select count(1) from dim_sku where supplier_name like '%test%';
select count(1) from dim_sku where supplier_name like '作废';
select count(1) from dim_sku where category_lvl1_name is null;
select count(1) from dim_sku where category_lvl2_name like '%test%' and category_lvl1_name not like '%test%';
select count(1) from dim_sku where prod_name like '%test%' and category_lvl1_name not like '%test%';
select count(1) from dim_user where uid_valid_flag=1;
select count(1),count(babytree_enc_user_id) from dim_user where uid_valid_flag=1;
select count(1),count(distinct babytree_enc_user_id) from dim_user where uid_valid_flag=1;
select * from dim_user where babytree_enc_user_id is null and uid_valid_flag=1;
select * from dim_user where babytree_enc_user_id is null and uid_valid_flag=1\G
use dw;
select count(1) from dim_user where uid_valid_flag=1 and babytree_enc_user_id is not null and babytree_enc_user_id='null';
